---
title : 'Safe Home'
author: "4ì¡°"
format: 
    dashboard:
        scrolling: true 
        css: style.css
editor: 
  markdown: 
    wrap: 72
---

# ì˜ë¢° ë‚´ìš©


## Row 




::: {.columns}

::: {.column width="50%"}
<img src="./data/houseprice/company_logo.png" style="display: block; margin-left: 250px; height: 400px; width: auto;" alt="Company Logo">

:::

::: {.column width="50%"}
<img src="./data/houseprice/ames.jpg" style="display: block; margin-left: 150px; height: 400px; width: auto;" alt="Ames">


:::

::: 

## Row

<p style="font-size: 35px; ">
**ğŸ› ï¸ìœ ì§€ë³´ìˆ˜ ì‚¬ì—…ì ì…ì¥ì—ì„œ í”„ë¡œëª¨ì…˜ ì „ëµ ê¸°íš**
<br>
**ğŸ¯ ìˆ˜ìš”ì™€ ìˆ˜ìµì„± ê¸°ë°˜ ì„¸ë¶€ íƒ€ê²Ÿ ì„¤ì •**
<br>
**ğŸ¯ íƒ€ì¼“ íŠ¹ì„± ë§ì¶¤í˜• í”„ë¡œëª¨ì…˜ ì „ëµ ì œì‹œ**
<br><br>
**ğŸ”ë°°ê²½**<br>
Ames ì§€ì—­ ìœ ì§€ë³´ìˆ˜ ê°œì—…ì„ ì•ë‘” ëˆëˆì”¨
<br>ëˆë˜ëŠ” ì‚¬ì—…ì„ ìœ„í•´ íƒ€ì—…ì²´ì™€ ì°¨ë³„í™”ë˜ëŠ” ë¶„ì„ì  ì ‘ê·¼ë²•ìœ¼ë¡œ ê³ ê° ìœ ì¹˜ì— ë‚˜ì„œë ¤ê³  í•œë‹¤.
<br>ë°ì´í„° ë¶„ì„ ì—­ëŸ‰ì„ ë°”íƒ•ìœ¼ë¡œ ìˆ˜ìš”ì™€ ìˆ˜ìµì„± ëª¨ë‘ ë…¸ë¦¬ë ¤ëŠ” ê·¸ì˜ ëª©ì ì€ ì´ë¤„ì§ˆ ìˆ˜ ìˆì„ ê²ƒì¸ê°€..
</p>

## Row

::: {.card title="OverallCond ì§€í‘œ í™œìš©ì˜ í•œê³„" style="width: 50%; margin: 30px auto 0 auto; font-size: 18px;"}

<p style="font-size: 22px; font-weight: bold; text-align: center;">
ğŸ“Œì •ëŸ‰ì  ì¢…í•© ìœ ì§€ë³´ìˆ˜ ì‚¬ì—…ì„± íŒë‹¨ ì§€í‘œë¥¼ ë§Œë“¤ì–´ì„œ í™œìš©í•˜ì!
</p>


```{python}
#| fig-width: 5
#| fig-height: 4

import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt


# 1. ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
df = pd.read_csv("./data/house/houseprice-with-lonlat.csv")

# 2. ë³€ìˆ˜ ë¦¬ìŠ¤íŠ¸ ì •ì˜
cond_cols = ["BsmtCond", "ExterCond", "GarageCond"]

# 3. ë“±ê¸‰ ë§¤í•‘
cond_map = {"Ex": 1, "Gd": 2, "TA": 3, "Fa": 4, "Po": 5}

# 4. Cond ê´€ë ¨ ë³€ìˆ˜: ìˆ˜ì¹˜ ë§¤í•‘ í›„ dropna()
for col in cond_cols:
    df[col + "_num"] = df[col].map(cond_map)

cond_corr_cols = [col + "_num" for col in cond_cols] + ["OverallCond"]
cond_corr_df = df[cond_corr_cols].dropna()
cond_corr = cond_corr_df.corr()

# 5. ì‹œê°í™”: OverallCond íˆíŠ¸ë§µ
plt.figure(figsize=(4,3))
sns.heatmap(cond_corr, annot=True, cmap="coolwarm", fmt=".2f", square=True)
plt.title("Correlation: OverallCond & Related Variables")
plt.tight_layout()
plt.show()
```



```{python}
import pandas as pd
import numpy as np
from sklearn.linear_model import LinearRegression
from mlxtend.feature_selection import SequentialFeatureSelector as SFS
import statsmodels.api as sm
import pandas as pd

from sklearn.linear_model import LassoCV
from sklearn.preprocessing import StandardScaler
import pandas as pd
import folium
from folium.plugins import MarkerCluster
import pandas as pd
import folium
from folium.plugins import MarkerCluster
import plotly.express as px
```

:::

## Row



```{python}
# ì§€ì—­ë³„ ìµœë¹ˆ ì§€í•˜ì‹¤ ìƒíƒœ ì ìˆ˜
# 1. ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
df = pd.read_csv('./data/house/houseprice-with-lonlat.csv')

# 2. ì§€í•˜ì‹¤ ìƒíƒœ ì ìˆ˜ ë§¤í•‘ (ë‚˜ì ìˆ˜ë¡ ë†’ì€ ì ìˆ˜)
bsmt_cond_mapping = {
    'Ex': 1,  # Excellent
    'Gd': 2,
    'TA': 3,
    'Fa': 4,
    'Po': 5   # Poor
}
df['BsmtCondScore'] = df['BsmtCond'].map(bsmt_cond_mapping)

# 3. ìœ„ê²½ë„ êµ¬ê°„í™” (ì†Œìˆ˜ ì…‹ì§¸ ìë¦¬ê¹Œì§€ ë°˜ì˜¬ë¦¼ â†’ ë°€ì§‘ë„ ê·¸ë£¹í™”)
df['Lat_bin'] = (df['Latitude'] * 1000).round() / 1000
df['Lon_bin'] = (df['Longitude'] * 1000).round() / 1000

# 4. ì§€ì—­ë³„ ìµœë¹ˆ ì§€í•˜ì‹¤ ìƒíƒœ ì ìˆ˜ ê³„ì‚°
mode_score = (
    df.dropna(subset=['BsmtCondScore'])
    .groupby(['Lat_bin', 'Lon_bin'])['BsmtCondScore']
    .agg(lambda x: x.mode().iloc[0])
    .reset_index()
)
mode_score['BsmtCondScore'] = mode_score['BsmtCondScore'].astype(str)
# 5. ìƒ‰ìƒ ë§¤í•‘ (ì ìˆ˜ ë†’ì„ìˆ˜ë¡ ë” ëˆˆì— ë„ëŠ” ìƒ‰ìƒ)
bsmt_color_map = {
    1: 'blue',       # Excellent
    2: 'green',      # Good
    3: 'gold',       # Typical
    4: 'orangered',  # Fair
    5: 'darkred'     # Poor
}

# 6. ì‹œê°í™”
fig = px.scatter_mapbox(
    mode_score,
    lat='Lat_bin',
    lon='Lon_bin',
    color='BsmtCondScore',
    category_orders={"BsmtCondScore": sorted(bsmt_color_map.keys())},
    color_discrete_map={str(k): v for k, v in bsmt_color_map.items()},
    zoom=12,
    mapbox_style='carto-positron',
    title= "ì§€í•˜ì‹¤ ìƒíƒœ ì ìˆ˜ (BsmtCondScore)"
)

# ì œëª© ê°€ìš´ë° ì •ë ¬
fig = fig.update_layout(
    title={
        'text': "ì§€í•˜ì‹¤ ìƒíƒœ ì ìˆ˜ (BsmtCondScore)",
        'x': 0.5  # ê¸°ì¤€ì  ê°€ìš´ë°
    },
    margin=dict(t=40, b=10)
)

fig = fig.update_traces(marker=dict(size=10, opacity=0.8))
fig.show(config={"scrollZoom": True})



```



```{python}
# ExterCond ì‹œê°í™”
# ì§€ì—­ë³„ ìµœë¹ˆ ì§€í•˜ì‹¤ ìƒíƒœ ì ìˆ˜
# 1. ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
df = pd.read_csv('./data/house/houseprice-with-lonlat.csv')

# 2. ì§€í•˜ì‹¤ ìƒíƒœ ì ìˆ˜ ë§¤í•‘ (ë‚˜ì ìˆ˜ë¡ ë†’ì€ ì ìˆ˜)
bsmt_cond_mapping = {
    'Ex': 1,  # Excellent
    'Gd': 2,
    'TA': 3,
    'Fa': 4,
    'Po': 5   # Poor
}
df['ExterCondScore'] = df['ExterCond'].map(bsmt_cond_mapping)

# 3. ìœ„ê²½ë„ êµ¬ê°„í™” (ì†Œìˆ˜ ì…‹ì§¸ ìë¦¬ê¹Œì§€ ë°˜ì˜¬ë¦¼ â†’ ë°€ì§‘ë„ ê·¸ë£¹í™”)
df['Lat_bin'] = (df['Latitude'] * 1000).round() / 1000
df['Lon_bin'] = (df['Longitude'] * 1000).round() / 1000

# 4. ì§€ì—­ë³„ ìµœë¹ˆ ì§€í•˜ì‹¤ ìƒíƒœ ì ìˆ˜ ê³„ì‚°
mode_score = (
    df.dropna(subset=['ExterCondScore'])
    .groupby(['Lat_bin', 'Lon_bin'])['ExterCondScore']
    .agg(lambda x: x.mode().iloc[0])
    .reset_index()
)
mode_score['ExterCondScore'] = mode_score['ExterCondScore'].astype(str)
# 5. ìƒ‰ìƒ ë§¤í•‘ (ì ìˆ˜ ë†’ì„ìˆ˜ë¡ ë” ëˆˆì— ë„ëŠ” ìƒ‰ìƒ)
Exter_color_map = {
    1: 'blue',       # Excellent
    2: 'green',      # Good
    3: 'gold',       # Typical
    4: 'orangered',  # Fair
    5: 'darkred'     # Poor
}

# 6. ì‹œê°í™”
fig = px.scatter_mapbox(
    mode_score,
    lat='Lat_bin',
    lon='Lon_bin',
    color='ExterCondScore',
    category_orders={"ExterCondScore": sorted(Exter_color_map.keys())},
    color_discrete_map={str(k): v for k, v in Exter_color_map.items()},
    zoom=12,
    mapbox_style='carto-positron',
    title= "ì™¸ì¥ì¬ ìƒíƒœ ì ìˆ˜ (ExterCondScore)"
)

fig = fig.update_traces(marker=dict(size=10, opacity=0.8))


# ì œëª© ê°€ìš´ë° ì •ë ¬
fig = fig.update_layout(
    title={
        'text': "ì™¸ì¥ì¬ ìƒíƒœ ì ìˆ˜ (ExterCondScore)",
        'x': 0.5,             # ê°€ìš´ë° ì •ë ¬
        'xanchor': 'center'   # ê¸°ì¤€ì  ê°€ìš´ë°
    }
)

fig.show(config={"scrollZoom": True})


```



## Row 

::: {.card title="ì°¨ê³ ì§€ ìƒíƒœ ì ìˆ˜" style="width: 50%; margin: 30px auto 0 auto; font-size: 18px;"}

```{python}
# GarageCond ì‹œê°í™”
# ì§€ì—­ë³„ ìµœë¹ˆ ì°¨ê³ ì§€ ìƒíƒœ ì ìˆ˜
# 1. ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
df = pd.read_csv('./data/house/houseprice-with-lonlat.csv')

# 2. ì°¨ê³ ì§€ ìƒíƒœ ì ìˆ˜ ë§¤í•‘ (ë‚˜ì ìˆ˜ë¡ ë†’ì€ ì ìˆ˜)
Garage_cond_mapping = {
    'Ex': 1,  # Excellent
    'Gd': 2,
    'TA': 3,
    'Fa': 4,
    'Po': 5   # Poor
}
df['GarageCondScore'] = df['GarageCond'].map(bsmt_cond_mapping)

# 3. ìœ„ê²½ë„ êµ¬ê°„í™” (ì†Œìˆ˜ ì…‹ì§¸ ìë¦¬ê¹Œì§€ ë°˜ì˜¬ë¦¼ â†’ ë°€ì§‘ë„ ê·¸ë£¹í™”)
df['Lat_bin'] = (df['Latitude'] * 1000).round() / 1000
df['Lon_bin'] = (df['Longitude'] * 1000).round() / 1000

# 4. ì§€ì—­ë³„ ìµœë¹ˆ ì°¨ê³ ì§€ ìƒíƒœ ì ìˆ˜ ê³„ì‚°
mode_score = (
    df.dropna(subset=['GarageCondScore'])
    .groupby(['Lat_bin', 'Lon_bin'])['GarageCondScore']
    .agg(lambda x: x.mode().iloc[0])
    .reset_index()
)
mode_score['GarageCondScore'] = mode_score['GarageCondScore'].astype(str)
# 5. ìƒ‰ìƒ ë§¤í•‘ (ì ìˆ˜ ë†’ì„ìˆ˜ë¡ ë” ëˆˆì— ë„ëŠ” ìƒ‰ìƒ)
Garage_color_map = {
    1: 'blue',       # Excellent
    2: 'green',      # Good
    3: 'gold',       # Typical
    4: 'orangered',  # Fair
    5: 'darkred'     # Poor
}

# 6. ì‹œê°í™”
fig = px.scatter_mapbox(
    mode_score,
    lat='Lat_bin',
    lon='Lon_bin',
    color='GarageCondScore',
    category_orders={"GarageCondScore": sorted(Garage_color_map.keys())},
    color_discrete_map={str(k): v for k, v in Garage_color_map.items()},
    zoom=12,
    mapbox_style='carto-positron',
    title= "ì°¨ê³ ì§€ ìƒíƒœ ì ìˆ˜ (GarageCondScore)"
)

fig = fig.update_traces(marker=dict(size=10, opacity=0.8))

# ì œëª© ê°€ìš´ë° ì •ë ¬
fig = fig.update_layout(
    title={
        'text': "ì°¨ê³ ì§€ ìƒíƒœ ì ìˆ˜ (GarageCondScore)",
        'x': 0.5,             # ê°€ìš´ë° ì •ë ¬
        'xanchor': 'center'   # ê¸°ì¤€ì  ê°€ìš´ë°
    }
)

fig.show(config={"scrollZoom": True})
```

:::

::: {.card title="ë¦¬ëª¨ë¸ë§ ì—°ë„ ë¶„í¬" style="width: 50%; margin: 30px auto 0 auto; font-size: 18px;"}

```{python}
# Year_Remod_Add ì‹œê°í™”
# 1. ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
df = pd.read_csv("./data/house/houseprice-with-lonlat.csv")

# 2. 10ë…„ ë‹¨ìœ„ë¡œ ë³€í™˜
df['RemodDecade'] = (df['YearRemodAdd'] // 10) * 10

# 3. ê²°ì¸¡ ì œê±°
df = df[['Latitude', 'Longitude', 'RemodDecade']].dropna()

# 4. Plotly ì‹œê°í™”
fig = px.scatter_mapbox(
    df,
    lat='Latitude',
    lon='Longitude',
    color='RemodDecade',
    color_continuous_scale='Plasma',  # ë˜ëŠ” Turbo, Viridis ë“±
    zoom=12,
    mapbox_style='carto-positron',
    title="ì „ì²´ ë¦¬ëª¨ë¸ë§ ì—°ë„ (10ë…„ ë‹¨ìœ„) ë¶„í¬"
)

fig = fig.update_traces(marker=dict(size=6, opacity=0.7))
# ì œëª© ê°€ìš´ë° ì •ë ¬
fig = fig.update_layout(
    title={
        'text': "ì „ì²´ ë¦¬ëª¨ë¸ë§ ì—°ë„ (10ë…„ ë‹¨ìœ„) ë¶„í¬",
        'x': 0.5,             # ê°€ìš´ë° ì •ë ¬
        'xanchor': 'center'   # ê¸°ì¤€ì  ê°€ìš´ë°
    }
)
fig.show(config={"scrollZoom": True})



```


:::

## Row

<p style="font-size: 22px; font-weight: bold; text-align: center;">
ğŸ”œ ë¶„ì‚°ëœ 4ê°œ ë³€ìˆ˜ë¥¼ ì¢…í•©í•œ Condition ì§€í‘œ ë“±ì¥ ì˜ˆì • !!
</p>

## Row 

## Qual ì£¼ìš” ë³€ìˆ˜ë³„ ì§€ë„ ë¶„í¬

::: {.card title="ì§€í•˜ì‹¤ í’ˆì§ˆ ì ìˆ˜" style="width: 50%; margin: 30px auto 0 auto; font-size: 18px;"}

```{python}

# ì§€ì—­ë³„ ì§€í•˜ì‹¤ í’ˆì§ˆ ì ìˆ˜
# 1. ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
df = pd.read_csv('./data/house/houseprice-with-lonlat.csv')

# 2. ì§€í•˜ì‹¤ í’ˆì§ˆ ì ìˆ˜ ë§¤í•‘ (ë‚˜ì ìˆ˜ë¡ ë†’ì€ ì ìˆ˜)
BsmtQual_mapping = {
    'Po': 1,  # Excellent
    'Ta': 2,
    'TA': 3,
    'Gd': 4,
    'Ex': 5   # Poor
}
df['BsmtQualScore'] = df['BsmtQual'].map(bsmt_cond_mapping)

# 3. ìœ„ê²½ë„ êµ¬ê°„í™” (ì†Œìˆ˜ ì…‹ì§¸ ìë¦¬ê¹Œì§€ ë°˜ì˜¬ë¦¼ â†’ ë°€ì§‘ë„ ê·¸ë£¹í™”)
df['Lat_bin'] = (df['Latitude'] * 1000).round() / 1000
df['Lon_bin'] = (df['Longitude'] * 1000).round() / 1000

# 4. ì§€ì—­ë³„ ì§€í•˜ì‹¤ í’ˆì§ˆ ì ìˆ˜ ê³„ì‚°
mode_score = (
    df.dropna(subset=['BsmtQualScore'])
    .groupby(['Lat_bin', 'Lon_bin'])['BsmtQualScore']
    .agg(lambda x: x.mode().iloc[0])
    .reset_index()
)
mode_score['BsmtQualScore'] = mode_score['BsmtQualScore'].astype(str)
# 5. ìƒ‰ìƒ ë§¤í•‘ (ì ìˆ˜ ë†’ì„ìˆ˜ë¡ ë” ëˆˆì— ë„ëŠ” ìƒ‰ìƒ)
bsmt_color_map = {
    1: 'darkred',       # Excellent
    2: 'orangered',      # Good
    3: 'gold',       # Typical
    4: 'green',  # Fair
    5: 'blue'     # Poor
}

# 6. ì‹œê°í™”
fig = px.scatter_mapbox(
    mode_score,
    lat='Lat_bin',
    lon='Lon_bin',
    color='BsmtQualScore',
    category_orders={"BsmtQualScore": sorted(bsmt_color_map.keys())},
    color_discrete_map={str(k): v for k, v in bsmt_color_map.items()},
    zoom=12,
    mapbox_style='carto-positron',
    title= "ì§€í•˜ì‹¤ í’ˆì§ˆ ì ìˆ˜ (BsmtQualScore)"
)

fig = fig.update_traces(marker=dict(size=10, opacity=0.8))
# ì œëª© ê°€ìš´ë° ì •ë ¬
fig = fig.update_layout(
    title={
        'text': "ì§€í•˜ì‹¤ í’ˆì§ˆ ì ìˆ˜ (BsmtQualScore)",
        'x': 0.5,             # ê°€ìš´ë° ì •ë ¬
        'xanchor': 'center'   # ê¸°ì¤€ì  ê°€ìš´ë°
    }
)

fig.show(config={"scrollZoom": True})



```

:::


::: {.card title="ì™¸ì¥ì¬ í’ˆì§ˆ ì ìˆ˜" style="width: 50%; margin: 30px auto 0 auto; font-size: 18px;"}


```{python}
# ì§€ì—­ë³„ ì™¸ì¥ì¬ í’ˆì§ˆ ì ìˆ˜
# 1. ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
df = pd.read_csv('./data/house/houseprice-with-lonlat.csv')

# 2. ì™¸ì¥ì¬ í’ˆì§ˆ ì ìˆ˜ ë§¤í•‘ (ë‚˜ì ìˆ˜ë¡ ë†’ì€ ì ìˆ˜)
ExterQual_mapping = {
    'Po': 1,  # Excellent
    'Fa': 2,
    'TA': 3,
    'Gd': 4,
    'Ex': 5   # Poor
}
df['ExterQualScore'] = df['ExterQual'].map(ExterQual_mapping)

# 3. ìœ„ê²½ë„ êµ¬ê°„í™” (ì†Œìˆ˜ ì…‹ì§¸ ìë¦¬ê¹Œì§€ ë°˜ì˜¬ë¦¼ â†’ ë°€ì§‘ë„ ê·¸ë£¹í™”)
df['Lat_bin'] = (df['Latitude'] * 1000).round() / 1000
df['Lon_bin'] = (df['Longitude'] * 1000).round() / 1000

# 4. ì§€ì—­ë³„ ì™¸ì¥ì¬ í’ˆì§ˆ ì ìˆ˜ ê³„ì‚°
mode_score = (
    df.dropna(subset=['ExterQualScore'])
    .groupby(['Lat_bin', 'Lon_bin'])['ExterQualScore']
    .agg(lambda x: x.mode().iloc[0])
    .reset_index()
)
mode_score['ExterQualScore'] = mode_score['ExterQualScore'].astype(str)

# 5. ìƒ‰ìƒ ë§¤í•‘ (ì ìˆ˜ ë†’ì„ìˆ˜ë¡ ë” ëˆˆì— ë„ëŠ” ìƒ‰ìƒ)
Exter_color_map = {
    1: 'darkred',       # Excellent
    2: 'orangered',      # Good
    3: 'gold',       # Typical
    4: 'green',  # Fair
    5: 'blue'     # Poor
}

# 6. ì‹œê°í™”
fig = px.scatter_mapbox(
    mode_score,
    lat='Lat_bin',
    lon='Lon_bin',
    color='ExterQualScore',
    category_orders={"ExterQualScore": sorted(bsmt_color_map.keys())},
    color_discrete_map={str(k): v for k, v in bsmt_color_map.items()},
    zoom=12,
    mapbox_style='carto-positron',
    title= "ì™¸ì¥ì¬ í’ˆì§ˆ ì ìˆ˜ (ExterQualScore)"
)

fig = fig.update_traces(marker=dict(size=10, opacity=0.8))
# ì œëª© ê°€ìš´ë° ì •ë ¬
fig = fig.update_layout(
    title={
        'text': "ì™¸ì¥ì¬ í’ˆì§ˆ ì ìˆ˜ (ExterQualScore)",
        'x': 0.5,             # ê°€ìš´ë° ì •ë ¬
        'xanchor': 'center'   # ê¸°ì¤€ì  ê°€ìš´ë°
    }
)


fig.show(config={"scrollZoom": True})


```


:::

## Row

::: {.card title="ë‚œë°© í’ˆì§ˆ ì ìˆ˜" style="width: 50%; margin: 30px auto 0 auto; font-size: 18px;"}


```{python}
# ì§€ì—­ë³„ ë‚œë°© í’ˆì§ˆ ì ìˆ˜
# 1. ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
df = pd.read_csv('./data/house/houseprice-with-lonlat.csv')

# 2. ë‚œë°© í’ˆì§ˆ ì ìˆ˜ ë§¤í•‘ (ë‚˜ì ìˆ˜ë¡ ë†’ì€ ì ìˆ˜)
HeatingQC_mapping = {
    'Po': 1,  # Excellent
    'Fa': 2,
    'TA': 3,
    'Gd': 4,
    'Ex': 5   # Poor
}
df['HeatingQCScore'] = df['HeatingQC'].map(HeatingQC_mapping)
# 3. ìœ„ê²½ë„ êµ¬ê°„í™” (ì†Œìˆ˜ ì…‹ì§¸ ìë¦¬ê¹Œì§€ ë°˜ì˜¬ë¦¼ â†’ ë°€ì§‘ë„ ê·¸ë£¹í™”)
df['Lat_bin'] = (df['Latitude'] * 1000).round() / 1000
df['Lon_bin'] = (df['Longitude'] * 1000).round() / 1000

# 4. ì§€ì—­ë³„ ì™¸ì¥ì¬ í’ˆì§ˆ ì ìˆ˜ ê³„ì‚°
mode_score = (
    df.dropna(subset=['HeatingQCScore'])
    .groupby(['Lat_bin', 'Lon_bin'])['HeatingQCScore']
    .agg(lambda x: x.mode().iloc[0])
    .reset_index()
)



# 6. ì‹œê°í™”
# ì ìˆ˜ ì»¬ëŸ¼ì„ ë¬¸ìì—´ë¡œ ë³€í™˜
mode_score['HeatingQCScore'] = mode_score['HeatingQCScore'].astype(str)

# ìƒ‰ìƒ ë§¤í•‘ (ì˜ë¯¸ ìˆëŠ” ìƒ‰ìƒ ì§ì ‘ ì§€ì •)
HeatingQC_color_map = {
    '1': 'darkred',     # ë§¤ìš° ë‚˜ì¨
    '2': 'orangered',   # ë‚˜ì¨
    '3': 'gold',        # ë³´í†µ
    '4': 'green',     # ì¢‹ìŒ
    '5': 'darkblue'     # ë§¤ìš° ì¢‹ìŒ
}

# ì‹œê°í™”

fig = px.scatter_mapbox(
    mode_score,
    lat='Lat_bin',
    lon='Lon_bin',
    color='HeatingQCScore',
    category_orders={"HeatingQCScore": ['1', '2', '3', '4', '5']},
    color_discrete_map=HeatingQC_color_map,
    zoom=12,
    mapbox_style='carto-positron',
    title="ë‚œë°© í’ˆì§ˆ ì ìˆ˜ (HeatingQCScore)"
)

fig = fig.update_traces(marker=dict(size=10, opacity=0.8))
fig = fig.update_layout(
    title={
        'text': "ë‚œë°© í’ˆì§ˆ ì ìˆ˜ (HeatingQCScore)",
        'x': 0.5,             # ê°€ìš´ë° ì •ë ¬
        'xanchor': 'center'   # ê¸°ì¤€ì  ê°€ìš´ë°
    }
)
fig.show(config={"scrollZoom": True})

```

:::

::: {.card title="ì§€ìƒ ìƒí™œê³µê°„ ì ìˆ˜" style="width: 50%; margin: 30px auto 0 auto; font-size: 18px;"}


```{python}
# ì§€ìƒ ìƒí™œê³µê°„ ì ìˆ˜
# 1. ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
df = pd.read_csv('./data/house/houseprice-with-lonlat.csv')
# 2. ì§€ìƒ ìƒí™œê³µê°„ ì ìˆ˜ ë§¤í•‘ (ë‚˜ì ìˆ˜ë¡ ë†’ì€ ì ìˆ˜)
df["GrLivArea_Score"] = pd.qcut(df["GrLivArea"], q=4, labels=[1, 2, 3, 4]).astype(int)

# 3. ìœ„ê²½ë„ êµ¬ê°„í™” (ì†Œìˆ˜ ì…‹ì§¸ ìë¦¬ê¹Œì§€ ë°˜ì˜¬ë¦¼ â†’ ë°€ì§‘ë„ ê·¸ë£¹í™”)
df['Lat_bin'] = (df['Latitude'] * 1000).round() / 1000
df['Lon_bin'] = (df['Longitude'] * 1000).round() / 1000

# 4. ì§€ìƒ ìƒí™œê³µê°„ ì ìˆ˜ ê³„ì‚°
mode_score = (
    df.dropna(subset=['GrLivArea_Score'])
    .groupby(['Lat_bin', 'Lon_bin'])['GrLivArea_Score']
    .agg(lambda x: x.mode().iloc[0])
    .reset_index()
)
mode_score['GrLivArea_Score'] = mode_score['GrLivArea_Score'].astype(str)
# 5. ìƒ‰ìƒ ë§¤í•‘ (ì ìˆ˜ ë†’ì„ìˆ˜ë¡ ë” ëˆˆì— ë„ëŠ” ìƒ‰ìƒ)
GrLivArea_color_map = {
    1: 'darkred',     # ë§¤ìš° ì¢ìŒ
    2: 'orangered',   # ì¢ìŒ
    3: 'gold',        # ë³´í†µ
    4: 'green',     # ë„“ìŒ
    5: 'darkblue'    # ë§¤ìš° ë„“ìŒ
}

# 6. ì‹œê°í™”
fig = px.scatter_mapbox(
    mode_score,
    lat='Lat_bin',
    lon='Lon_bin',
    color='GrLivArea_Score',
    category_orders={"GrLivArea_Score": sorted(GrLivArea_color_map.keys())},
    color_discrete_map={str(k): v for k, v in GrLivArea_color_map.items()},
    zoom=12,
    mapbox_style='carto-positron',
    title= "ì§€ìƒ ìƒí™œ ê³µê°„ ì ìˆ˜ (GrLivArea_Score)"
)

fig = fig.update_traces(marker=dict(size=10, opacity=0.8))
fig = fig.update_layout(
    title={
        'text': "ì§€ìƒ ìƒí™œ ê³µê°„ ì ìˆ˜ (GrLivArea_Score)",
        'x': 0.5,             # ê°€ìš´ë° ì •ë ¬
        'xanchor': 'center'   # ê¸°ì¤€ì  ê°€ìš´ë°
    }
)
fig.show(config={"scrollZoom": True})


```


:::

## Row

<p style="font-size: 22px; font-weight: bold; text-align: center;">
ğŸ’¬Condition **VS** Quality, ë¬´ì—‡ì´ ë‹¤ë¥¼ê¹Œ?
</p>

## Row 

# ìˆ˜ìš”

$$
Maintenace Score = 0.3BsmtCond + 0.3ExterCond+ 0.2GarageCond + 0.2YearRemodAdd
$$

## Row

<p style="font-size: 22px; font-weight: bold; text-align: center;">
-   ê°€ì •: ìƒíƒœê°€ ì•ˆì¢‹ê±°ë‚˜ ë¦¬ëª¨ë¸ë§ ê²½ê³¼ ì—°ë„ê°€ ì˜¤ë˜ë  ìˆ˜ë¡ ìœ ì§€ë³´ìˆ˜ ìˆ˜ìš”ê°€ ë†’ì„ ê²ƒì´ë‹¤.
</p>

## Row

::: {.card title="Maintencance Score ë³€ìˆ˜ ì „ì²˜ë¦¬"}

+--------------+---------------+----------------+---------------------------------------------+
| ë³€ìˆ˜         | ì˜ë¯¸          | Type           | ì „ì²˜ë¦¬ ê¸°ì¤€                                 |
+:============:+:=============:+:==============:+:===========================================:+
| BsmtCond     | ì§€í•˜ì‹¤ ìƒíƒœ   | ë²”ì£¼í˜•(Ex\~Po) | `Ex`=1 \~ `Po`=5ë¡œ ì—­ìˆœ ì ìˆ˜í™”, ê²°ì¸¡ì¹˜ ì œê±° |
+--------------+---------------+----------------+---------------------------------------------+
| ExterCond    | ì™¸ë²½ ìƒíƒœ     | ë²”ì£¼í˜•(Ex\~Po) | `Ex`=1 \~ `Po`=5ë¡œ ì—­ìˆœ ì ìˆ˜í™”              |
+--------------+---------------+----------------+---------------------------------------------+
| GarageCond   | ì°¨ê³  ìƒíƒœ     | ë²”ì£¼í˜•(Ex\~Po) | `Ex`=1 \~ `Po`=5ë¡œ ì—­ìˆœ ì ìˆ˜í™”, ê²°ì¸¡ì¹˜ ì œê±° |
+--------------+---------------+----------------+---------------------------------------------+
| YearRemodAdd | ë¦¬ëª¨ë¸ë§ ì—°ë„ | ìˆ«ìí˜•(YYYY)   | 10ë…„ ë‹¨ìœ„ ê³¼ê±° ì—­ìˆœ ì ìˆ˜í™”                  |
+--------------+---------------+----------------+---------------------------------------------+

-   Maintenance Score ê°€ì¤‘ì¹˜ ì‚°ì •ë²•

+--------------+----------------------------------+------------+------------+
| ë³€ìˆ˜         | ì˜ë¯¸                             | ì¤‘ìš”ë„     | ê°€ì¤‘ì¹˜     |
+:============:+:================================:+:==========:+:==========:+
| BsmtCond     | ëˆ„ìˆ˜ã†ê³°íŒ¡ì´ ë“± ìœ„í—˜ ë…¸ì¶œ        | â˜…â˜…â˜…        | 0.3        |
+--------------+----------------------------------+------------+------------+
| ExterCond    | ì™¸ë¶€ ëˆ„ìˆ˜ã†ê· ì—´ã†ë‹¨ì—´ê³¼ ì§ê²°     | â˜…â˜…â˜…        | 0.3        |
+--------------+----------------------------------+------------+------------+
| GarageCond   | ìœ„ì™€ ë™ì¼ ìœ„í—˜ ì¡´ì¬í•˜ë‚˜ ë¹„ìƒí™œê¶Œ | â˜…â˜…         | 0.2        |
+--------------+----------------------------------+------------+------------+
| YearRemodAdd | ì‹œì„¤/ìì¬ ë…¸í›„í™” ì •ë„            | â˜…â˜…         | 0.2        |
+--------------+----------------------------------+------------+------------+
:::

## Row

::: {.card title="Maintenace Score ìƒìœ„ 10% ì§€ì—­ ì‹œê°í™”" style="width: 50%; margin: 0 auto; font-size: 18px;"}

```{python}
from IPython.display import IFrame

IFrame(src='./data/house/top10.html', width='100%', height='600px')


```

:::

# ìˆ˜ìµì„±

$$
Margin Score = 0.4QualAvg + 0.3GrlivArea+ 0.3Saleprice
$$

## Row

<p style="font-size: 22px; font-weight: bold; text-align: center;">
-   ê°€ì •1: ì–‘ì§ˆì˜ ì‹œì„¤/ìì¬ì´ê³  ë©´ì ì´ í´ìˆ˜ë¡ ìœ ì§€ë³´ìˆ˜ ë‹¨ê°€ê°€ ë†’ì„ ê²ƒì´ë‹¤.

-   ê°€ì •2: ì£¼íƒê°€ê²©ì´ ë†’ì„ ìˆ˜ë¡ ì§€ë¶ˆ ìš©ì˜ê°€ í´ ê²ƒì´ë‹¤.
</p>

## Row


::: {.card title="Margin Score ë³€ìˆ˜ ì „ì²˜ë¦¬"}
+-------------+---------------+------------------+-------------------------------------------+
| ë³€ìˆ˜        | ì˜ë¯¸          | Type             | ì „ì²˜ë¦¬ ê¸°ì¤€                               |
+:===========:+:=============:+:================:+:=========================================:+
| BsmtQual    | ì§€í•˜ì‹¤ í’ˆì§ˆ   | ë²”ì£¼í˜•(Ex\~Po)   | `Ex`=5 \~ `Po`=1ë¡œ ì ìˆ˜í™”, ê²°ì¸¡ì¹˜ 0ì      |
+-------------+---------------+------------------+-------------------------------------------+
| ExterQual   | ì™¸ë²½ í’ˆì§ˆ     | ë²”ì£¼í˜•(Ex\~Po)   | `Ex`=5 \~ `Po`=1ë¡œ ì ìˆ˜í™”, ê²°ì¸¡ì¹˜ 0ì      |
+-------------+---------------+------------------+-------------------------------------------+
| GarageQual  | ì°¨ê³  í’ˆì§ˆ     | ë²”ì£¼í˜•(Ex\~Po)   | `Ex`=5 \~ `Po`=1ë¡œ ì ìˆ˜í™”, ê²°ì¸¡ì¹˜ 0ì      |
+-------------+---------------+------------------+-------------------------------------------+
| KitchenQual | ì£¼ë°© í’ˆì§ˆ     | ë²”ì£¼í˜•(Ex\~Po)   | `Ex`=5 \~ `Po`=1ë¡œ ì ìˆ˜í™”, ê²°ì¸¡ì¹˜ 0ì      |
+-------------+---------------+------------------+-------------------------------------------+
| FireplaceQu | ë²½ë‚œë¡œ í’ˆì§ˆ\` | ë²”ì£¼í˜•(Ex\~Po)   | `Ex`=5 \~ `Po`=1ë¡œ ì ìˆ˜í™”, ê²°ì¸¡ì¹˜ 0ì      |
+-------------+---------------+------------------+-------------------------------------------+
| HeatingQC   | ë‚œë°© í’ˆì§ˆ     | ë²”ì£¼í˜•(Ex\~Po)   | `Ex`=5 \~ `Po`=1ë¡œ ì ìˆ˜í™”, ê²°ì¸¡ì¹˜ 0ì      |
+-------------+---------------+------------------+-------------------------------------------+
| GrlivArea   | ì§€ìƒìƒí™œë©´ì   | ìˆ«ìí˜•(ì œê³±ë¯¸í„°) | 4ë¶„ìœ„ìˆ˜ ë¶„í• , ìƒìœ„ êµ¬ê°„ë¶€í„° 4\~1ì  ì ìˆ˜í™” |
+-------------+---------------+------------------+-------------------------------------------+
| Saleprice   | ì§‘ê°€ê²©        | ìˆ«ìí˜•(ë‹¬ëŸ¬)     | 4ë¶„ìœ„ìˆ˜ ë¶„í• , ìƒìœ„ êµ¬ê°„ë¶€í„° 4\~1ì  ì ìˆ˜í™” |
+-------------+---------------+------------------+-------------------------------------------+

-   Margin Score ê°€ì¤‘ì¹˜ ì‚°ì •ë²•

+-----------+-------------------------------------------+-----------+-----------+
| ë³€ìˆ˜      | ì˜ë¯¸                                      | ì¤‘ìš”ë„    | ê°€ì¤‘ì¹˜    |
+:=========:+:=========================================:+:=========:+:=========:+
| AvgQual   | Quality ê´€ë ¨ ë³€ìˆ˜ í‰ê· ê°’ìœ¼ë¡œ              | â˜…â˜…â˜…â˜…      | 0.4       |
|           |                                           |           |           |
|           | ë§ˆê°ì¬/ì„¤ë¹„ í’ˆì§ˆ ë†’ì„ ìˆ˜ë¡ ë‹¨ê°€ ìƒìŠ¹      |           |           |
+-----------+-------------------------------------------+-----------+-----------+
| GrlivArea | ë©´ì  \* í‰ë‹¹ ë‹¨ê°€ = ìˆ˜ìµ                  | â˜…â˜…â˜…       | 0.3       |
+-----------+-------------------------------------------+-----------+-----------+
| Saleprice | ê³ ê°€ì¼ìˆ˜ë¡ ì¬ì • ì—¬ìœ ì™€ ë¦¬ëª¨ë¸ë§ ì˜í–¥ ì¡´ì¬ | â˜…â˜…â˜…       | 0.3       |
+-----------+-------------------------------------------+-----------+-----------+

:::

## Row

::: {.card title="Margine Score ìƒìœ„ 50ê°œ ì‹œê°í™”" style="width: 50%; margin: 0 auto; font-size: 18px;"}

```{python}
from IPython.display import IFrame

IFrame(src='./data/house/final.html', width='100%', height='600px')


```

:::

## Row

<p style="font-size: 22px; font-weight: bold; text-align: center;">
ğŸ“Œìµœì¢… íƒ€ê²Ÿ ê²°ì •: ìˆ˜ìš”ì™€ ìˆ˜ìµì„±ì„ ë°˜ì˜í•œ ìƒìœ„ 50ì„¸ëŒ€ ì„ ì •
</p>

## Row

# ê²°ë¡ 

<p style="font-size: 28px; font-weight: bold; text-align: center;">
**ğŸ“ˆíƒ€ê²Ÿ íŠ¹ì„± í•™ìŠµ ê²°ê³¼ì— ë”°ë¥¸ ë§ˆì¼€íŒ… ì „ëµ ê¸°íš**

-   ë¶„ì„ ëŒ€ìƒ: [**â‘  ê³ ê°€ ì£¼íƒ(ìƒìœ„ 25%)**]{.underline} **vs â‘¡ [ì €ê°€ ì£¼íƒ(í•˜ìœ„ 25%)]{.underline}**

-   ë¶„ì„ ëª©ì : ê³ ê°€ ì£¼íƒê³¼ ì €ê°€ ì£¼íƒì˜ ê°€ê²©ì— Condition/Qualityê°€ ë¯¸ì¹˜ëŠ” ì˜í–¥ë ¥ ë¶„ì„

-   ë¶„ì„ ëª¨ë¸: ElasticNet íšŒê·€
</p>

## Row

$$
Y : Sale Price
$$

## Row

$$
X : Variables  - Condition, Quality 
$$

## Row

::: {.card title="ğŸ§ í•™ìŠµ ê²°ê³¼ íšŒê·€ ê³„ìˆ˜"}
+-----------+--------------+----------------------------+----------------------------+
| êµ¬ë¶„      | ë³€ìˆ˜         | ê³ ê°€ ì£¼íƒ                  | ì €ê°€ ì£¼íƒ                  |
+:=========:+:============:+:==========================:+:==========================:+
| Quality   | KithchenQual | [**15182.51**]{.underline} | 1740.66                    |
+-----------+--------------+----------------------------+----------------------------+
| Quality   | FireplaceQu  | [**8792.61**]{.underline}  | 427.00                     |
+-----------+--------------+----------------------------+----------------------------+
| Quality   | BsmtQual     | [**22680.81**]{.underline} | 2721.31                    |
+-----------+--------------+----------------------------+----------------------------+
| Quality   | ExterQual    | [**13663.82**]{.underline} | 1260.12                    |
+-----------+--------------+----------------------------+----------------------------+
| Quality   | GarageQual   | [**8108.78**]{.underline}  | 2104.78                    |
+-----------+--------------+----------------------------+----------------------------+
| Quality   | HeatingQC    | [**3362.56**]{.underline}  | 1451.55                    |
+-----------+--------------+----------------------------+----------------------------+
| Condition | BsmtCond     | 1585.07                    | [**-682.69**]{.underline}  |
+-----------+--------------+----------------------------+----------------------------+
| Condition | ExterCond    | -371.11                    | [**-734.09**]{.underline}  |
+-----------+--------------+----------------------------+----------------------------+
| Condition | GarageCond   | 2122.78                    | [**-2149.66**]{.underline} |
+-----------+--------------+----------------------------+----------------------------+
â—í•´ì„ ìœ ì˜ : Qual ë†’ì„ìˆ˜ë¡ í’ˆì§ˆ ì¢‹ìŒ ì˜ë¯¸ / Cond ë†’ì„ìˆ˜ë¡ ìƒíƒœ ë‚˜ì¨ ì˜ë¯¸
:::


## Row

<p style="font-size: 22px; font-weight: bold; text-align: center;">
âœ…ê³ ê°€ ì£¼íƒ : Quality ì¤‘ì‹¬ ë³€ìˆ˜ê°€ ê°€ê²© í˜•ì„±ì— í° ì˜í–¥

âœ…ì €ê°€ ì£¼íƒ : Condition ì¤‘ì‹¬ ë³€ìˆ˜ê°€ ê°€ê²© í˜•ì„±ì— í° ì˜í–¥

</p>

## Row

::: {.card title="ğŸ’¡**ì¸ì‚¬ì´íŠ¸ ì ìš©**"}
+-----------+--------------------+--------------------------------------------------------+
| íƒ€ê²Ÿ      | ì „ëµ               | ì‹¤í–‰ë°©ì•ˆ                                               |
+:=========:+:==================:+:======================================================:+
| ê³ ê°€ ì£¼íƒ | í”„ë¦¬ë¯¸ì—„ í’ˆì§ˆ ê°œì„  | ã†í”„ë¦¬ë¯¸ì—„ ìì¬, ë§ˆê° í’ˆì§ˆ í‚¤ì›Œë“œë¡œ ë¸Œë¡œìŠˆì–´ ìš°í¸ ë°°í¬ |
|           |                    |                                                        |
|           | â†’ ì£¼íƒ ê°€ì¹˜ UP     | ã†íƒ€ê²Ÿ ì£¼íƒ ë°€ì§‘ ì§€ì—­ ë°°ë„ˆ ì„¤ì¹˜                        |
+-----------+--------------------+--------------------------------------------------------+
| ì €ê°€ ì£¼íƒ | ì£¼ê±°í™˜ê²½ ìƒíƒœ ê°œì„  | ã†ëˆ„ìˆ˜, ë‹¨ì—´ ë°©ì§€ ë“± í‚¤ì›Œë“œë¡œ ë¸Œë¡œìŠˆì–´ ìš°í¸ ë°°í¬       |
|           |                    |                                                        |
|           | â†’ ì£¼íƒ ê°€ì¹˜ UP     | ã†íƒ€ê²Ÿ ì£¼íƒ ë°€ì§‘ ì§€ì—­ ë°°ë„ˆ ì„¤ì¹˜                        |
+-----------+--------------------+--------------------------------------------------------+
:::

## Row

